<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <?!= include('dialog-css'); ?>
  </head>
  <body>
      <main class="container">
        <div class="container" id="divSheet" style="margin-bottom:0.3rem">
          <div class="row" style="align-items: center;">
            <div class="col">
              Enter a sheet ID<br>
              <input type="text" class="form-control" id="sheetId" value="<?= gsGetSheetId() ?>" />
            </div>
            <div class="col-auto">
              <button class="btn btn-info" id="btnSetSheet">Set Sheet</button>
            </div>
          </div>
          <div class="row alert alert-danger d-none" id="divNoSheet">
            <strong>You need to set the file with the configuration settings first.</strong>
            <span id="errMsg"></span>
          </div>
        </div>
        <div id="divInputs">
        </div>
        <div id="cPanel">
          <div class="row" style="align-items: center;padding-top:0.3rem;padding-bottom:0.3rem;border-top: .1rem lightgrey solid;">
            <div class="col colRight">
              Name of the new document:<br>
              <input type="text" class="form-control" id="docName" />
            </div>
            <div class="col">
              Options for blank placeholders:<br>
              <select class="form-control" id="replaceOption">
                <option value="keep">Keep the placeholder in the new document</option>
                <option value="replace">Replace placeholders with blanks</option>
              </select>
            </div>
          </div>
          <div class="row" id="rowBtn" style="justify-content:right">
            <div class="col" style="text-align:center">
              <div class="btn btn-danger d-none" id="divErrMsg" style="padding:0.3rem">
                Please fill in the highlighted fields correctly.
              </div>
              <div class="btn btn-danger d-none" id="divErrDocName" style="padding:0.3rem">
                Please enter a name for the new document.
              </div>
              <div class="btn btn-danger d-none" id="divGsErrMsg" style="padding:0.3rem"></div>
            </div>
            <div class="col-auto" style="text-align:center">
              <button class="btn btn-info" id="btnCreate" onclick="createLetter()">Create letter...</button>

              <button class="btn btn-info d-none" id="btnCreating" type="button" disabled>
                <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                Creating Letter...
              </button>

            </div>
          </div>
          <div class="row d-none" id="rowLink">
            <div class="col" style="text-align:center" id="colLink">
              <a href="#" id="newDocLink" target="_blank">Link to new document</a>
            </div>
          </div>
        </div>
      </main>
  </body>
  <?!= include('dialog-js'); ?>
</html>
